# Vlasov-Poisson PINN æ±‚è§£å™¨

åŸºäºç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œ(PINNs)çš„ 1D Vlasov-Poisson ç³»ç»Ÿæ±‚è§£å™¨ï¼Œæ”¯æŒå¤šç§ç¥ç»ç½‘ç»œæ¶æ„ï¼ˆMLPã€Transformer ç­‰ï¼‰ï¼Œå¹¶å…·æœ‰å®Œæ•´çš„é…ç½®è¿½è¸ªåŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ¯ **å¤šæ¶æ„æ”¯æŒ**: MLPã€Transformerã€Lightweight Transformerã€Hybrid Transformer
- ğŸ’¾ **é…ç½®è‡ªåŠ¨ä¿å­˜**: æ¯æ¬¡è®­ç»ƒè‡ªåŠ¨ä¿å­˜å®Œæ•´é…ç½®ï¼ˆJSON + TXTï¼‰
- ğŸ” **é…ç½®å¯¹æ¯”å·¥å…·**: è½»æ¾å¯¹æ¯”ä¸åŒå®éªŒçš„å‚æ•°è®¾ç½®
- ğŸ“Š **å½’ä¸€åŒ–è¾“å…¥**: æ”¹è¿›çš„è®­ç»ƒç¨³å®šæ€§
- ğŸ“ˆ **å¯è§†åŒ–**: è‡ªåŠ¨ç”Ÿæˆç›¸ç©ºé—´æ¼”åŒ–å›¾å’ŒæŸå¤±æ›²çº¿
- ğŸš€ **ç®€å•æ˜“ç”¨**: ä¸€è¡Œä»£ç åˆ‡æ¢æ¨¡å‹æ¶æ„

---

## ğŸ“š æ–¹ç¨‹ç»„ä»‹ç»

Vlasov-Poissonç³»ç»Ÿæ˜¯ç­‰ç¦»å­ä½“ç‰©ç†ä¸­çš„åŸºæœ¬æ–¹ç¨‹ç»„ï¼Œæè¿°äº†æ— ç¢°æ’ç­‰ç¦»å­ä½“ä¸­ç²’å­åˆ†å¸ƒå‡½æ•°çš„æ¼”åŒ–ï¼š

### Vlasovæ–¹ç¨‹ (6Dç›¸ç©ºé—´)
$$\frac{\partial f}{\partial t} + v \cdot \nabla_x f + \frac{q}{m} E \cdot \nabla_v f = 0$$

### Poissonæ–¹ç¨‹
$$\nabla^2 \phi = -\frac{\rho}{\varepsilon_0} = -\frac{q}{\varepsilon_0} \int f \, dv$$

### ç”µåœº
$$E = -\nabla \phi$$

å…¶ä¸­ï¼š
- $f(x,v,t)$: ç²’å­åˆ†å¸ƒå‡½æ•° (6Dç›¸ç©ºé—´å¯†åº¦)
- $\phi(x,t)$: ç”µåŠ¿
- $E(x,t)$: ç”µåœº
- $\rho(x,t)$: ç”µè·å¯†åº¦
- $q/m$: ç”µè·è´¨é‡æ¯”
- $\varepsilon_0$: çœŸç©ºä»‹ç”µå¸¸æ•°

## ğŸ“ æ–‡ä»¶ç»“æ„

```
vlasov_poisson_system/
â”œâ”€â”€ vlasov_poisson_solver.py    # ä¸»æ±‚è§£å™¨ç±»
â”œâ”€â”€ run_vlasov_examples.py      # ä½¿ç”¨ç¤ºä¾‹å’Œæ¼”ç¤º
â””â”€â”€ README.md                   # è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹PythonåŒ…ï¼š

```bash
pip install deepxde numpy matplotlib scipy
```

**æ³¨æ„**: Vlasov-Poissonç³»ç»Ÿæ˜¯6ç»´é—®é¢˜ï¼Œå¯¹è®¡ç®—èµ„æºè¦æ±‚æé«˜ï¼Œå»ºè®®ä½¿ç”¨GPUåŠ é€Ÿã€‚

### 2. åŸºç¡€ä½¿ç”¨

```python
from vlasov_poisson_solver import VlasovPoissonSolver

# åˆ›å»ºLandaué˜»å°¼æ±‚è§£å™¨
solver = VlasovPoissonSolver(
    x_domain=(-1.0, 1.0),      # ç©ºé—´åŸŸ
    v_domain=(-3.0, 3.0),      # é€Ÿåº¦åŸŸ
    time_domain=(0.0, 1.0),    # æ—¶é—´åŸŸ
    case="landau_damping"      # é¢„è®¾æ¡ˆä¾‹
)

# è®¾ç½®é—®é¢˜
solver.setup_geometry_and_conditions()

# åˆ›å»ºç¥ç»ç½‘ç»œæ¨¡å‹
solver.create_model()

# è®­ç»ƒæ¨¡å‹
solver.train()

# å¯è§†åŒ–ç»“æœ
solver.visualize_phase_space_evolution()
solver.analyze_plasma_dynamics()
```

### 3. è¿è¡Œç¤ºä¾‹

```bash
python run_vlasov_examples.py
```

ç¨‹åºæä¾›5ä¸ªç»å…¸ç­‰ç¦»å­ä½“ç‰©ç†ç¤ºä¾‹ï¼š
1. **Landaué˜»å°¼** - ç­‰ç¦»å­ä½“æ³¢çš„æ— ç¢°æ’é˜»å°¼
2. **åŒæµä¸ç¨³å®šæ€§** - ä¸¤æŸåå‘ç”µå­æŸçš„ä¸ç¨³å®šæ€§
3. **Bump-on-tailä¸ç¨³å®šæ€§** - é«˜èƒ½ç”µå­å°¾éƒ¨é©±åŠ¨çš„ä¸ç¨³å®šæ€§
4. **å‚æ•°ç ”ç©¶** - ä¸åŒæ³¢æ•°å¯¹é˜»å°¼ç‡çš„å½±å“
5. **é«˜çº§åˆ†æ** - æ·±å…¥çš„ç›¸ç©ºé—´ç»“æ„åˆ†æ

## ğŸ”§ ä¸»è¦åŠŸèƒ½

### VlasovPoissonSolverç±»

#### æ ¸å¿ƒæ–¹æ³•
- **åˆå§‹åŒ–**: `__init__(x_domain, v_domain, time_domain, case)`
- **è®¾ç½®é—®é¢˜**: `setup_geometry_and_conditions()`
- **åˆ›å»ºæ¨¡å‹**: `create_model(num_domain, num_boundary, num_initial, layer_sizes)`
- **æ¨¡å‹è®­ç»ƒ**: `train(adam_iterations, adam_lr, weights_pde)`
- **é¢„æµ‹**: `predict(inputs)` - è¿”å›$[f, \phi]$

#### åˆ†æå·¥å…·
- **å®è§‚é‡è®¡ç®—**: `compute_macroscopic_quantities()` - å¯†åº¦ã€å¹³å‡é€Ÿåº¦ã€æ¸©åº¦
- **ç›¸ç©ºé—´å¯è§†åŒ–**: `visualize_phase_space_evolution()`
- **ç­‰ç¦»å­ä½“åŠ¨åŠ›å­¦åˆ†æ**: `analyze_plasma_dynamics()`
- **åˆå§‹æ¡ä»¶å¯è§†åŒ–**: `visualize_initial_conditions()`

#### æ¨¡å‹ç®¡ç†
- **ä¿å­˜æ¨¡å‹**: `save_model(filename)`
- **åŠ è½½æ¨¡å‹**: `load_model(filename)`

### é¢„è®¾æ¡ˆä¾‹

| æ¡ˆä¾‹ | ç‰©ç†ç°è±¡ | ç‰¹ç‚¹ |
|------|----------|------|
| `landau_damping` | Landaué˜»å°¼ | ç­‰ç¦»å­ä½“æ³¢çš„æ— ç¢°æ’é˜»å°¼ |
| `two_stream` | åŒæµä¸ç¨³å®šæ€§ | ä¸¤æŸåå‘æµçš„ç›¸äº’ä½œç”¨ |
| `bump_on_tail` | å°¾éƒ¨ä¸ç¨³å®šæ€§ | é«˜èƒ½ç²’å­é©±åŠ¨çš„ä¸ç¨³å®šæ€§ |

## ğŸ“Š ä½¿ç”¨æŠ€å·§

### 1. ç½‘ç»œè®¾è®¡è¦ç‚¹
- **6Då¤æ‚æ€§**: æ¯”ä½ç»´PDEå¤æ‚æ•°åƒå€ï¼Œéœ€è¦å¤§å‹ç½‘ç»œ
- **æ¨èç»“æ„**: `[3, 128, 128, 128, 128, 2]` æˆ–æ›´å¤§
- **æ¿€æ´»å‡½æ•°**: `tanh`å¯¹ç­‰ç¦»å­ä½“ç³»ç»Ÿæ•ˆæœæœ€å¥½
- **è¾“å‡º**: 2ç»´ (åˆ†å¸ƒå‡½æ•°$f$, ç”µåŠ¿$\phi$)

### 2. è®­ç»ƒç­–ç•¥
- **å¤§é‡é‡‡æ ·ç‚¹**: 6Dç³»ç»Ÿéœ€è¦8000+åŸŸå†…é‡‡æ ·ç‚¹
- **å°å­¦ä¹ ç‡**: å»ºè®®0.0005-0.001
- **é•¿æ—¶é—´è®­ç»ƒ**: 15000+ Adamè¿­ä»£ + L-BFGS
- **æ–¹ç¨‹æƒé‡**: Vlasovæƒé‡ > Poissonæƒé‡ (å¦‚$[1.0, 0.1]$)

### 3. è®¡ç®—èµ„æºä¼˜åŒ–
- **GPUåŠ é€Ÿ**: å¼ºçƒˆæ¨èä½¿ç”¨CUDA
- **å†…å­˜ç®¡ç†**: 6Dç³»ç»Ÿå†…å­˜éœ€æ±‚å·¨å¤§
- **æ‰¹å¤„ç†**: åˆç†è®¾ç½®batch sizeé¿å…å†…å­˜æº¢å‡º

### 4. ç‰©ç†å‚æ•°è°ƒä¼˜
- **æ—¶é—´åŸŸ**: ä¸è¦è®¾ç½®å¤ªé•¿ï¼Œé¿å…æ•°å€¼ä¸ç¨³å®š
- **é€Ÿåº¦åŸŸ**: å¿…é¡»åŒ…å«ä¸»è¦ç²’å­é€Ÿåº¦åˆ†å¸ƒ
- **ç©ºé—´åŸŸ**: é€šå¸¸ä½¿ç”¨å‘¨æœŸæ€§è¾¹ç•Œæ¡ä»¶

## ğŸ¯ ç»å…¸åº”ç”¨æ¡ˆä¾‹

### 1. Landaué˜»å°¼ç ”ç©¶
```python
solver = VlasovPoissonSolver(
    x_domain=(-np.pi, np.pi),
    v_domain=(-4.0, 4.0),
    time_domain=(0.0, 10.0),
    case="landau_damping"
)
# ç ”ç©¶ä¸åŒæ³¢æ•°$k$çš„é˜»å°¼ç‡$\gamma$
```

### 2. åŒæµä¸ç¨³å®šæ€§
```python
solver = VlasovPoissonSolver(
    v_domain=(-3.0, 3.0),  # è¦†ç›–ä¸¤æŸæµé€Ÿåº¦
    case="two_stream"
)
# è§‚å¯ŸæŸæµé—´çš„èƒ½é‡äº¤æ¢å’Œç›¸ç©ºé—´æ··åˆ
```

### 3. ç­‰ç¦»å­ä½“åŠ çƒ­
```python
solver = VlasovPoissonSolver(
    v_domain=(-2.0, 5.0),  # æ‰©å±•åˆ°é«˜èƒ½åŒºåŸŸ
    case="bump_on_tail"
)
# ç ”ç©¶é«˜èƒ½ç²’å­å¯¹ç­‰ç¦»å­ä½“åŠ çƒ­çš„å½±å“
```

## ğŸ”¬ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰åˆå§‹åˆ†å¸ƒ
```python
class CustomVlasovSolver(VlasovPoissonSolver):
    def initial_condition_f(self, inputs):
        x, v, t = inputs[:, 0:1], inputs[:, 1:2], inputs[:, 2:3]
        # è‡ªå®šä¹‰åˆ†å¸ƒå‡½æ•°
        return custom_distribution(x, v)
    
    def initial_condition_phi(self, inputs):
        # è‡ªå®šä¹‰åˆå§‹ç”µåŠ¿
        return custom_potential(inputs)
```

### å®è§‚é‡æ—¶é—´æ¼”åŒ–
å®è§‚é‡çš„è®¡ç®—å…¬å¼ï¼š

- **ç²’å­å¯†åº¦**: $n(x,t) = \int f(x,v,t) \, dv$
- **å¹³å‡é€Ÿåº¦**: $\langle v \rangle(x,t) = \frac{1}{n(x,t)} \int v \cdot f(x,v,t) \, dv$  
- **æ¸©åº¦**: $T(x,t) \propto \frac{1}{n(x,t)} \int (v - \langle v \rangle)^2 f(x,v,t) \, dv$

```python
# è®¡ç®—å¯†åº¦ã€æµé€Ÿã€æ¸©åº¦çš„æ—¶ç©ºæ¼”åŒ–
times = np.linspace(0, t_max, 50)
x_points = np.linspace(x_min, x_max, 30)

for t in times:
    macro_quantities = solver.compute_macroscopic_quantities(x_points, t)
    density = macro_quantities['density']
    mean_velocity = macro_quantities['mean_velocity']
    temperature = macro_quantities['temperature']
```

### èƒ½é‡å®ˆæ’æ£€éªŒ
```python
# æ£€éªŒæ€»èƒ½é‡å®ˆæ’
kinetic_energy = âˆ«âˆ« (vÂ²/2) f(x,v,t) dx dv
potential_energy = (Îµâ‚€/2) âˆ« EÂ²(x,t) dx
total_energy = kinetic_energy + potential_energy
```

æ›´ç²¾ç¡®çš„æ•°å­¦è¡¨è¾¾å¼ï¼š

$$\text{åŠ¨èƒ½} = \iint \frac{v^2}{2} f(x,v,t) \, dx \, dv$$

$$\text{åŠ¿èƒ½} = \frac{\varepsilon_0}{2} \int E^2(x,t) \, dx$$

$$\text{æ€»èƒ½é‡} = \text{åŠ¨èƒ½} + \text{åŠ¿èƒ½}$$

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. è®¡ç®—å¤æ‚æ€§
- **ç»´åº¦è¯…å’’**: 6Dç³»ç»Ÿæ¯”2Då¤æ‚10Â³-10â¶å€
- **è®­ç»ƒæ—¶é—´**: å¯èƒ½éœ€è¦æ•°å°æ—¶åˆ°æ•°å¤©
- **å†…å­˜éœ€æ±‚**: é€šå¸¸éœ€è¦16GB+å†…å­˜
- **GPUå¿…éœ€**: CPUè®­ç»ƒå‡ ä¹ä¸å¯è¡Œ

### 2. æ•°å€¼ç¨³å®šæ€§
- **æ—¶é—´æ­¥é•¿**: Vlasovæ–¹ç¨‹å¯¹æ—¶é—´æ­¥é•¿æ•æ„Ÿ
- **é€Ÿåº¦è¾¹ç•Œ**: å¿…é¡»åŒ…å«æ‰€æœ‰é‡è¦çš„é€Ÿåº¦æˆåˆ†
- **å‘¨æœŸæ€§**: ç©ºé—´è¾¹ç•Œæ¡ä»¶å½±å“ç»“æœå‡†ç¡®æ€§

### 3. ç‰©ç†æœ‰æ•ˆæ€§
- **è´¨é‡å®ˆæ’**: $\int f \, dv$ åº”è¯¥å®ˆæ’
- **èƒ½é‡å®ˆæ’**: æ€»èƒ½é‡åº”è¯¥å®ˆæ’(æˆ–æŒ‰å·²çŸ¥è§„å¾‹å˜åŒ–)
- **ç†µå¢**: Hå®šç†è¦æ±‚ç†µå•è°ƒå¢åŠ 

### 4. æ”¶æ•›æ€§æ£€éªŒ
- **ç½‘æ ¼æ— å…³æ€§**: å¢åŠ é‡‡æ ·ç‚¹æ•°éªŒè¯ç»“æœ
- **æ—¶é—´æ”¶æ•›**: å»¶é•¿æ—¶é—´åŸŸæ£€æŸ¥é•¿æœŸè¡Œä¸º
- **å‚æ•°æ•æ„Ÿæ€§**: æµ‹è¯•ä¸åŒåˆå§‹æ¡ä»¶çš„é²æ£’æ€§

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

| æ¡ˆä¾‹ | åŸŸå†…ç‚¹æ•° | è®­ç»ƒæ—¶é—´ | GPUå†…å­˜ | æ¨èé…ç½® |
|------|----------|----------|---------|----------|
| Landaué˜»å°¼ | 8000 | ~2å°æ—¶ | 8GB | RTX 3080+ |
| åŒæµä¸ç¨³å®š | 6000 | ~1.5å°æ—¶ | 6GB | RTX 3070+ |
| Bump-on-tail | 7000 | ~2.5å°æ—¶ | 10GB | RTX 3090+ |

## ğŸ” è°ƒè¯•æŒ‡å—

### å¸¸è§é—®é¢˜
1. **è®­ç»ƒä¸æ”¶æ•›**
   - å‡å°å­¦ä¹ ç‡
   - å¢åŠ ç½‘ç»œæ·±åº¦
   - è°ƒæ•´PDEæƒé‡æ¯”ä¾‹
   - æ£€æŸ¥åˆå§‹æ¡ä»¶åˆç†æ€§

2. **å†…å­˜ä¸è¶³**
   - å‡å°‘é‡‡æ ·ç‚¹æ•°
   - é™ä½ç½‘ç»œå¤æ‚åº¦
   - ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯

3. **ç»“æœä¸ç‰©ç†**
   - æ£€æŸ¥è¾¹ç•Œæ¡ä»¶è®¾ç½®
   - éªŒè¯åˆå§‹æ¡ä»¶
   - å¢åŠ è®­ç»ƒæ—¶é—´
   - è°ƒæ•´æ—¶é—´åŸŸèŒƒå›´

## ğŸ“– ç†è®ºèƒŒæ™¯

### Landaué˜»å°¼
Landaué˜»å°¼æ˜¯ç­‰ç¦»å­ä½“ç‰©ç†ä¸­çš„é‡è¦ç°è±¡ï¼Œç”±äºç²’å­ä¸æ³¢çš„å…±æŒ¯ç›¸äº’ä½œç”¨å¯¼è‡´æ³¢çš„æ— ç¢°æ’é˜»å°¼ã€‚é˜»å°¼ç‡ç”±Landauç§¯åˆ†ç»™å‡ºï¼š

$$\gamma = -\pi \frac{\omega_p^2}{k^2} \left.\frac{\partial f_0}{\partial v}\right|_{v=\omega/k}$$

### åŒæµä¸ç¨³å®šæ€§
å½“ä¸¤æŸç²’å­æµç›¸å¯¹è¿åŠ¨æ—¶ï¼Œä¼šå‘ç”Ÿé™ç”µä¸ç¨³å®šæ€§ï¼Œå¢é•¿ç‡ç”±ï¼š

$$\gamma = \frac{\omega_p}{2}\left(\frac{\omega}{kv_0}\right)^{1/3}$$

å…¶ä¸­$v_0$æ˜¯æŸæµç›¸å¯¹é€Ÿåº¦ã€‚

## ğŸ“š å‚è€ƒèµ„æ–™

### ç»å…¸æ•™æ
- Birdsall & Langdon: "Plasma Physics via Computer Simulation"
- Krall & Trivelpiece: "Principles of Plasma Physics"
- Boyd & Sanderson: "The Physics of Plasmas"

### é‡è¦è®ºæ–‡
- Landau (1946): "On the vibrations of the electronic plasma"
- Vlasov (1938): "On vibration properties of electron gas"
- Dawson (1983): "Particle simulation of plasmas"

### æ•°å€¼æ–¹æ³•
- Cheng & Knorr (1976): "The integration of the Vlasov equation"
- Filbet & SonnendrÃ¼cker (2003): "Comparison of Eulerian Vlasov solvers"

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç å’Œæ”¹è¿›ï¼å¯ä»¥è€ƒè™‘çš„æ‰©å±•æ–¹å‘ï¼š
- å¤šç‰©ç§ç­‰ç¦»å­ä½“ (ç”µå­+ç¦»å­)
- ç£åŒ–ç­‰ç¦»å­ä½“ (æ·»åŠ ç£åœº)
- ç›¸å¯¹è®ºæ€§æ•ˆåº”
- ç¢°æ’é¡¹ (Fokker-Planck)
- 2D/3Dç©ºé—´æ‰©å±•

## ğŸ“„ è®¸å¯è¯

MIT License

---

**âš ï¸ å…è´£å£°æ˜**: Vlasov-Poissonç³»ç»Ÿæ˜¯æå…¶å¤æ‚çš„6ç»´é—®é¢˜ï¼Œæœ¬æ±‚è§£å™¨ä¸»è¦ç”¨äºç ”ç©¶å’Œæ•™å­¦ç›®çš„ã€‚å¯¹äºå®é™…ç­‰ç¦»å­ä½“ç‰©ç†åº”ç”¨ï¼Œè¯·è°¨æ…éªŒè¯ç»“æœçš„ç‰©ç†åˆç†æ€§ã€‚