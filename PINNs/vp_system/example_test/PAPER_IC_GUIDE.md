# 论文初始条件说明

## 📝 概述

已添加论文中的双流不稳定性初始条件（equation 6.7）。这是一个2D2V简化到1D1V的版本。

## 🔬 数学公式

论文中的初始条件（equation 6.7）：

$$f_0(x, v) = \frac{1}{4\pi}(1 + \alpha \cos(\omega \cdot x))[\exp(-(v - v_0)^2/2) + \exp(-(v + v_0)^2/2)]$$

### 参数设置

根据论文：
- **α = 0.003**: 非常小的空间扰动幅度（0.3%）
- **ω = 0.2**: 空间波数（对应波长 λ = 2π/ω ≈ 31.416）
- **v₀ = 2.4**: 两束流的速度（分别为 +v₀ 和 -v₀）
- **相空间**: Ω_x = [0, 2π/0.2]² 和 Ω_v = ℝ²（1D中简化为 [0, 31.416] × [-6, 6]）

### 物理意义

这个初始条件描述了：
1. **两束反向运动的电子束**，速度中心分别在 v = +2.4 和 v = -2.4
2. **很小的空间密度扰动**（仅 0.3%），这样可以观察不稳定性的线性增长阶段
3. **热速度 σ = 1**（方差为1的高斯分布）

与标准双流不稳定性的区别：
- 标准版本：较大扰动（~10%），快速进入非线性阶段
- 论文版本：极小扰动（0.3%），精确观察线性增长率

## 🚀 快速使用

### 方法 1: 使用预设（推荐）

```python
# 在 config.py 中取消注释
use_ic_preset('two_stream_paper')
```

### 方法 2: 手动配置

```python
# 在 config.py 中修改
INITIAL_CONDITION = {
    'type': 'two_stream_paper',
    'paper_v0': 2.4,
    'paper_alpha': 0.003,
    'paper_omega': 0.2,
}

# 调整域参数
DOMAIN = {
    't_max': 40.0,          # 论文中展示 t=0,20,30,40
    'x_max': 31.416,        # 2π/0.2 (一个波长)
    'v_max': 6.0,           # 覆盖 ±v_0 = ±2.4
}
```

### 完整工作流程

```bash
# 1. 设置配置（使用预设）
python setup_paper_ic.py

# 2. 可视化初始条件
python test_paper_ic.py

# 3. 开始训练
python main.py
```

## 📊 预期结果

根据论文和理论：
- **线性增长阶段**: t = 0 到 t ≈ 20，不稳定性指数增长
- **饱和阶段**: t ≈ 20 到 t ≈ 30，增长减缓
- **非线性混合**: t > 30，相空间结构复杂化

### 可观测量

1. **电场能量**: 应该呈现指数增长后饱和
2. **密度扰动**: 从 0.3% 增长到 O(1)
3. **相空间涡旋**: 在 x-v 平面形成特征涡旋结构

## 🔧 参数调整建议

### 增加扰动观察快速演化

```python
INITIAL_CONDITION['paper_alpha'] = 0.01  # 增加到 1%
```

### 改变波长研究不同模式

```python
INITIAL_CONDITION['paper_omega'] = 0.4   # 更短波长
DOMAIN['x_max'] = 15.708                 # 2π/0.4
```

### 改变束流速度

```python
INITIAL_CONDITION['paper_v0'] = 3.0      # 更快的束流
# 注意: v_0/σ 越大，不稳定性增长率越高
```

## 📚 理论背景

### 增长率估算

对于双流不稳定性，线性增长率 γ 满足色散关系：

$$\omega^2 = k^2 v_0^2 - \frac{k^4 \sigma^2}{2}$$

不稳定条件：$v_0 > k\sigma/\sqrt{2}$

对于我们的参数：
- k = ω = 0.2
- v₀ = 2.4
- σ = 1.0
- v₀/(kσ) = 2.4/0.2 = 12 >> 1/√2 ✓ 强不稳定

### 时间尺度

- **增长时间**: τ_grow ~ 1/γ ≈ 几个 ω_p^-1
- **饱和时间**: τ_sat ~ 10-20 ω_p^-1
- **混合时间**: τ_mix ~ 30-40 ω_p^-1

## 🎯 验证标准

训练成功的标志：
1. ✅ 初始密度扰动 ≈ 0.3%
2. ✅ 归一化：∫∫f dxdv = L_x ≈ 31.416
3. ✅ 相空间显示两个分离的束（v = ±2.4）
4. ✅ 时间演化展现不稳定性增长和饱和

## 📖 参考信息

- 论文 Section 6.4: Two-stream instability in 2D2V setting
- 使用 ASAP Lie-Trotter time-splitting scheme
- 离散化: N_x = 200, N_v = 200（论文中）
- 我们的PINN方法: 连续函数逼近，不需要网格离散化

## 💡 提示

1. **扰动很小**: α = 0.003 意味着初始扰动几乎看不见，这是正常的
2. **需要长时间训练**: 由于扰动小，PINN需要学习微小的初始差异
3. **使用高精度模型**: 推荐使用 `hybrid_transformer` 或 `transformer`
4. **监控密度扰动**: 观察 max(n) - min(n) 随时间的变化

## 🔍 调试

如果结果不理想：
1. 检查初始条件归一化: `python test_paper_ic.py`
2. 增加训练轮数: `epochs = 20000`
3. 减小学习率: `learning_rate = 5e-5`
4. 增加采样点: `n_pde = 20000`
5. 增加初始条件权重: `weight_ic = 5.0`

---

**祝实验成功！** 🎉
