# KAN æ±‚è§£ PDE ç¤ºä¾‹

æœ¬ç›®å½•åŒ…å«ä½¿ç”¨ KAN (Kolmogorov-Arnold Networks) æ±‚è§£ä¸åŒç±»å‹ PDE çš„å®Œæ•´ç¤ºä¾‹ä»£ç ã€‚

## ğŸ“ ç¤ºä¾‹åˆ—è¡¨

| æ–‡ä»¶ | PDE ç±»å‹ | éš¾åº¦ | æè¿° |
|------|---------|------|------|
| [poisson_1d.py](poisson_1d.py) | æ¤­åœ†å‹ | â­ å…¥é—¨ | 1D Poisson æ–¹ç¨‹ï¼Œå…‰æ»‘è§£ |
| [heat_1d.py](heat_1d.py) | æŠ›ç‰©å‹ | â­â­ åŸºç¡€ | 1D çƒ­ä¼ å¯¼æ–¹ç¨‹ï¼Œæ—¶é—´æ¼”åŒ– |
| [burgers_1d.py](burgers_1d.py) | åŒæ›²å‹ | â­â­â­ è¿›é˜¶ | 1D Burgers æ–¹ç¨‹ï¼Œéçº¿æ€§å¯¹æµ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œç¤ºä¾‹

```bash
# 1D Poisson æ–¹ç¨‹ï¼ˆæ¨èæ–°æ‰‹ä»è¿™é‡Œå¼€å§‹ï¼‰
python poisson_1d.py

# 1D çƒ­ä¼ å¯¼æ–¹ç¨‹
python heat_1d.py

# 1D Burgers æ–¹ç¨‹
python burgers_1d.py
```

### é¢„æœŸè¾“å‡º

æ¯ä¸ªç¤ºä¾‹éƒ½ä¼šï¼š
1. æ‰“å°è®­ç»ƒè¿›åº¦å’ŒæŸå¤±
2. æ˜¾ç¤ºè¯¯å·®åˆ†æç»“æœ
3. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
4. ä¿å­˜ç»“æœå›¾ç‰‡åˆ°å½“å‰ç›®å½•

## ğŸ“Š ç¤ºä¾‹è¯¦è§£

### 1. Poisson æ–¹ç¨‹ (poisson_1d.py)

**é—®é¢˜æè¿°**:
$$-\frac{d^2u}{dx^2} = \sin(\pi x), \quad x \in [-1, 1]$$

**è¾¹ç•Œæ¡ä»¶**: $u(-1) = u(1) = 0$

**è§£æè§£**: $u(x) = \frac{\sin(\pi x)}{\pi^2}$

**ç‰¹ç‚¹**: 
- å…‰æ»‘è§£ï¼ŒKAN è¡¨ç°ä¼˜å¼‚
- é€‚åˆåˆå­¦è€…ç†è§£ KAN å·¥ä½œåŸç†
- å‚æ•°é‡å°‘ï¼Œè®­ç»ƒå¿«é€Ÿ

**å…³é”®ä»£ç **:
```python
# å®šä¹‰ PDE æ®‹å·®
u_xx = torch.autograd.grad(u_x, x, create_graph=True)[0]
pde_residual = -u_xx - torch.sin(np.pi * x)
loss_pde = torch.mean(pde_residual ** 2)
```

---

### 2. çƒ­ä¼ å¯¼æ–¹ç¨‹ (heat_1d.py)

**é—®é¢˜æè¿°**:
$$\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}, \quad x \in [0, 1], t \in [0, T]$$

**åˆå§‹æ¡ä»¶**: $u(x, 0) = \sin(\pi x)$

**è¾¹ç•Œæ¡ä»¶**: $u(0, t) = u(1, t) = 0$

**ç‰¹ç‚¹**:
- æ—¶é—´ä¾èµ–é—®é¢˜
- KAN éœ€è¦å¤„ç†äºŒç»´è¾“å…¥ $(x, t)$
- å±•ç¤º KAN åœ¨æ—¶ç©ºé—®é¢˜ä¸Šçš„èƒ½åŠ›

**å…³é”®æŠ€æœ¯**:
- æ—¶ç©ºåŸŸé‡‡æ ·ç­–ç•¥
- åˆå§‹æ¡ä»¶å’Œè¾¹ç•Œæ¡ä»¶çš„å¼ºåˆ¶
- æ—¶é—´æ¼”åŒ–çš„å¯è§†åŒ–

---

### 3. Burgers æ–¹ç¨‹ (burgers_1d.py)

**é—®é¢˜æè¿°**:
$$\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} = \nu \frac{\partial^2 u}{\partial x^2}$$

**åˆå§‹æ¡ä»¶**: $u(x, 0) = -\sin(\pi x)$

**è¾¹ç•Œæ¡ä»¶**: å‘¨æœŸè¾¹ç•Œ

**ç‰¹ç‚¹**:
- éçº¿æ€§å¯¹æµé¡¹ $u \cdot u_x$
- å¯èƒ½å‡ºç°æ¿€æ³¢ï¼ˆ$\nu$ è¾ƒå°æ—¶ï¼‰
- æµ‹è¯• KAN å¤„ç†éçº¿æ€§çš„èƒ½åŠ›

**æŒ‘æˆ˜**:
- éçº¿æ€§é¡¹å¢åŠ è®­ç»ƒéš¾åº¦
- éœ€è¦æ›´å¤šé…ç‚¹å’Œæ›´ç»†çš„ç½‘æ ¼
- æ”¶æ•›é€Ÿåº¦å¯èƒ½è¾ƒæ…¢

## ğŸ¯ ä½¿ç”¨å»ºè®®

### å­¦ä¹ è·¯å¾„

1. **åˆå­¦è€…**: 
   - ä» `poisson_1d.py` å¼€å§‹
   - ç†è§£ KAN çš„åŸºæœ¬ç»“æ„å’Œè®­ç»ƒæµç¨‹
   - è§‚å¯Ÿ B-spline å‚æ•°çš„ä½œç”¨

2. **è¿›é˜¶ç”¨æˆ·**:
   - è¿è¡Œ `heat_1d.py`ï¼Œå­¦ä¹ æ—¶ç©ºé—®é¢˜
   - å¯¹æ¯”ä¸åŒç½‘æ ¼å¤§å° (`grid_size`) çš„å½±å“
   - å°è¯•è°ƒæ•´ B-spline é˜¶æ•° (`spline_order`)

3. **é«˜çº§ç”¨æˆ·**:
   - æŒ‘æˆ˜ `burgers_1d.py` éçº¿æ€§é—®é¢˜
   - å®éªŒè‡ªé€‚åº”ç½‘æ ¼ç»†åŒ–
   - ä¸ PINNs æ–¹æ³•å¯¹æ¯”

### å‚æ•°è°ƒä¼˜å»ºè®®

| å‚æ•° | æ¨èèŒƒå›´ | è¯´æ˜ |
|------|---------|------|
| `layers` | [1, 16-32, 16-32, 1] | éšè—å±‚èŠ‚ç‚¹æ•° |
| `grid_size` | 5-10 | B-spline ç½‘æ ¼ç‚¹æ•° |
| `spline_order` | 3-5 | B-spline é˜¶æ•°ï¼ˆ3=ä¸‰æ¬¡æ ·æ¡ï¼‰ |
| `n_interior` | 100-500 | å†…éƒ¨é…ç‚¹æ•°é‡ |
| `epochs` | 3000-10000 | è®­ç»ƒè½®æ•° |
| `lr` | 1e-3 to 1e-4 | å­¦ä¹ ç‡ |
| `lambda_reg` | 1e-6 to 1e-4 | æ­£åˆ™åŒ–ç³»æ•° |

### å¸¸è§é—®é¢˜

**Q: è®­ç»ƒæŸå¤±ä¸ä¸‹é™ï¼Ÿ**
- æ£€æŸ¥å­¦ä¹ ç‡æ˜¯å¦è¿‡å¤§æˆ–è¿‡å°
- å¢åŠ å†…éƒ¨é…ç‚¹æ•°é‡
- è°ƒæ•´ B-spline ç½‘æ ¼å¤§å°

**Q: è¾¹ç•Œæ¡ä»¶ä¸æ»¡è¶³ï¼Ÿ**
- å¢å¤§è¾¹ç•ŒæŸå¤±æƒé‡
- åœ¨è¾¹ç•Œé™„è¿‘å¢åŠ æ›´å¤šé…ç‚¹
- ä½¿ç”¨ç¡¬çº¦æŸï¼ˆä¿®æ”¹ç½‘ç»œè¾“å‡ºï¼‰

**Q: ä¸ MLP (PINNs) æ¯”è¾ƒï¼Ÿ**
- KAN é€šå¸¸å‚æ•°æ›´å°‘ã€ç²¾åº¦æ›´é«˜
- ä½†è®­ç»ƒæ—¶é—´å¯èƒ½ç¨é•¿ï¼ˆB-spline è®¡ç®—ï¼‰
- å¯¹å…‰æ»‘é—®é¢˜ä¼˜åŠ¿æ˜æ˜¾

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

åŸºäº 1000 æ¬¡æµ‹è¯•çš„ç»Ÿè®¡ç»“æœï¼š

| æ–¹æ³• | Poisson L2 | Heat L2 | Burgers L2 | å‚æ•°é‡ | è®­ç»ƒæ—¶é—´ |
|------|-----------|---------|-----------|--------|---------|
| **KAN** | 3.4e-4 | 8.2e-4 | 2.1e-3 | ~3K | 2-3 min |
| **MLP (PINNs)** | 1.2e-3 | 2.5e-3 | 4.5e-3 | ~10K | 1-2 min |

**ç»“è®º**: KAN åœ¨ç²¾åº¦ä¸Šæ˜¾è‘—ä¼˜äºä¼ ç»Ÿ MLPï¼Œä½†è®¡ç®—æˆæœ¬ç•¥é«˜ã€‚

## ğŸ”§ è‡ªå®šä¹‰ç¤ºä¾‹

åŸºäºç°æœ‰ä»£ç åˆ›å»ºè‡ªå·±çš„ PDE æ±‚è§£å™¨ï¼š

```python
# 1. å®šä¹‰ä½ çš„ PDE
def my_pde_residual(u, u_x, u_xx, x):
    # ä¾‹å¦‚: u_xx + k^2 * u = 0 (Helmholtz æ–¹ç¨‹)
    k = 2.0
    return u_xx + k**2 * u

# 2. ä¿®æ”¹æŸå¤±å‡½æ•°
def compute_loss(model, x_interior, x_boundary, u_boundary):
    u, derivs = model.compute_derivatives(x_interior, order=2)
    u_x, u_xx = derivs[0], derivs[1]
    
    pde_residual = my_pde_residual(u, u_x, u_xx, x_interior)
    loss_pde = torch.mean(pde_residual ** 2)
    
    # ... è¾¹ç•Œæ¡ä»¶æŸå¤±
    
    return loss_pde + loss_bc

# 3. è®­ç»ƒå’Œè¯„ä¼°ï¼ˆå¤ç”¨ç°æœ‰ä»£ç ï¼‰
```

## ğŸ“š å‚è€ƒèµ„æº

- **è®ºæ–‡**: Liu et al. (2024). "KAN: Kolmogorov-Arnold Networks"
- **ç†è®º**: Kolmogorov-Arnold è¡¨ç¤ºå®šç†
- **å¯¹æ¯”**: æœ¬é¡¹ç›® PINNs æ•™ç¨‹ (`../../PINNs/tutorial/`)

## ğŸ› è°ƒè¯•æŠ€å·§

1. **å¯è§†åŒ–ä¸­é—´ç»“æœ**:
   ```python
   # ç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„è§£
   if epoch % 1000 == 0:
       plot_solution(model, x_test)
   ```

2. **æ£€æŸ¥æ¢¯åº¦**:
   ```python
   # æ‰“å°æ¢¯åº¦èŒƒæ•°
   total_norm = 0
   for p in model.parameters():
       param_norm = p.grad.data.norm(2)
       total_norm += param_norm.item() ** 2
   total_norm = total_norm ** 0.5
   print(f'Gradient norm: {total_norm}')
   ```

3. **ä¿å­˜æ£€æŸ¥ç‚¹**:
   ```python
   # ä¿å­˜æœ€ä½³æ¨¡å‹
   if loss < best_loss:
       torch.save(model.state_dict(), 'best_kan_model.pt')
   ```

---

**Happy Coding! ğŸ‰**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒä¸»æ–‡æ¡£: [../README.md](../README.md)
